# Документація проекту: Shopify Fulfillment Tool v7.0

## 1. Огляд проекту

**Shopify Fulfillment Tool** — це настільний додаток для Windows, розроблений для автоматизації та оптимізації процесу комплектації замовлень для інтернет-магазинів, що працюють на платформі Shopify.

Основна мета інструменту — аналізувати експортні файли замовлень та залишків на складі, визначати, які замовлення можуть бути виконані, та генерувати необхідні документи (пакувальні листи, файли для кур'єрських служб).

Додаток має графічний інтерфейс користувача (GUI), що робить його доступним для співробітників складу без необхідності роботи з командним рядком.

## 2. Функціонал

Версія 7.0 включає наступний основний функціонал:

- **Управління сесіями:** Кожен сеанс роботи зберігається в окрему унікальну папку з поточною датою, що дозволяє легко організовувати та знаходити результати аналізу та звіти.
- **Аналіз замовлень:** Програма проводить комплексний аналіз, порівнюючи потреби в товарах із замовлень із поточними залишками на складі.
- **Пріоритезація замовлень:** Аналіз автоматично пріоритезує замовлення з більшою кількістю позицій, щоб максимізувати кількість виконаних замовлень.
- **Інтерактивна таблиця аналізу:**
    - Користувачі можуть вручну змінювати статус виконання замовлення (`Fulfillable` / `Not Fulfillable`) подвійним кліком миші.
    - При ручній зміні статусу програма **автоматично перераховує залишки на складі** та оновлює всю статистику.
    - Підтримується "примусове" виконання замовлень, навіть якщо товару немає в облікових залишках (для випадків, коли товар є фізично).
- **Валідація файлів у реальному часі:** При завантаженні файлів `.csv` програма миттєво перевіряє наявність необхідних колонок і показує статус (✓ або ✗), що запобігає помилкам при аналізі.
- **Генерація звітів:**
    - **Головний звіт аналізу:** Детальний `.xlsx` файл з усіма даними по кожній позиції в замовленнях.
    - **Пакувальні листи:** Генерація кастомізованих пакувальних листів на основі гнучких фільтрів.
    - **Файли для кур'єрських служб (Stock Exports):** Генерація файлів у потрібному форматі для різних служб доставки.
- **Гнучке налаштування через UI:**
    - **Редактор фільтрів:** Зручний інтерфейс для налаштування правил фільтрації для звітів без необхідності писати JSON вручну.
    - **Налаштування тегів:** Можливість задавати правила для автоматичного додавання тегів до замовлень.
    - **Загальні налаштування:** Можливість змінювати роздільник для CSV-файлів, поріг низького залишку та шляхи до файлів.
- **Автоматизація збірки (CI/CD):** Налаштовано GitHub Actions для автоматичної збірки `.exe` файлу при створенні нового релізу на GitHub.

## 3. Інструкція користувача

1.  **Запуск програми:** Запустіть `.exe` файл.
2.  **Створення сесії:**
    -   Натисніть кнопку **"Create New Session"**. Програма створить нову унікальну папку для результатів вашої роботи.
    -   Після цього стануть активними кнопки завантаження файлів.
3.  **Завантаження файлів:**
    -   Натисніть **"Load Orders File (.csv)"** і виберіть файл експорту замовлень з Shopify.
    -   Натисніть **"Load Stock File (.csv)"** і виберіть файл із залишками на складі.
    -   Поруч із назвою кожного файлу з'явиться іконка статусу валідації. Зелена галочка (✓) означає, що файл коректний. Червоний хрестик (✗) означає, що у файлі відсутні необхідні колонки (деталі можна побачити у підказці при наведенні).
4.  **Запуск аналізу:**
    -   Коли обидва файли завантажено, кнопка **"Run Analysis"** стане активною. Натисніть її.
    -   Дочекайтеся завершення аналізу. Результати з'являться у вкладках "Analysis Data" та "Statistics".
5.  **Ручне редагування (опційно):**
    *   Перейдіть на вкладку "Analysis Data".
    *   Щоб змінити статус замовлення, зробіть **подвійний клік** на будь-якому рядку цього замовлення.
    *   Статус зміниться, а всі дані (залишки, статистика) автоматично перерахуються.
    *   Якщо товару для "примусового" виконання недостатньо на складі, ви побачите повідомлення про помилку.
6.  **Генерація звітів:**
    -   Після успішного аналізу стануть активними кнопки **"Create Packing List"** та **"Create Stock Export"**.
    -   Натисніть на потрібну кнопку та виберіть тип звіту зі списку.
    -   Згенерований файл буде збережено у папці поточної сесії.
7.  **Налаштування (опційно):**
    -   Натисніть кнопку **"Settings"**, щоб відкрити вікно налаштувань.
    -   Тут ви можете змінювати загальні параметри, правила тегування та гнучко налаштовувати фільтри для звітів за допомогою нового візуального редактора.

## 4. Аналіз поточної версії (7.0)

#### ✅ Сильні сторони

-   **Модульність та структура:** Код добре структурований, логіка розділена на пакети (`gui`, `shopify_tool`), що спрощує підтримку та подальшу розробку.
-   **Гнучкість та конфігурація:** Майже вся поведінка програми (шляхи, фільтри, правила) винесена у `config.json` і може бути налаштована через зручний UI, що робить інструмент дуже гнучким.
-   **Високий рівень UX (User Experience):** Додано багато функцій, орієнтованих на зручність користувача: сесії, валідація файлів "на льоту", інтерактивне редагування, візуальний редактор фільтрів.
-   **Надійність:** Використання окремих потоків для довготривалих операцій (аналіз, валідація) запобігає "зависанню" інтерфейсу. Наявність тестів для бекенд-логіки забезпечує стабільність.
-   **Автоматизація розгортання:** Налаштований CI/CD процес для збірки `.exe` файлу значно спрощує доставку нових версій кінцевим користувачам.

#### ⚠️ Можливі покращення та недоліки

-   **Система тегів:** Поточний UI для налаштування правил тегування є базовим. Його можна значно розширити, додавши конструктор правил, аналогічний редактору фільтрів (наприклад, "Якщо `Shipping_Provider` == 'DHL', додати тег 'EXPRESS'").
-   **Тестування UI:** Графічний інтерфейс наразі не покритий автоматичними тестами, що створює ризик регресій у майбутньому при зміні UI. Можна розглянути впровадження інструментів для тестування GUI, таких як `pytest-qt` або спеціалізовані скрипти.
-   **Обробка "фізичних" залишків:** Примусове виконання замовлення з товаром, якого немає на обліку, хоч і працює, але створює у DataFrame новий рядок з нульовими даними. Це може ускладнити подальший аналіз. Можливо, варто розглянути створення окремої "віртуальної" таблиці для таких товарів.
-   **Централізація логіки:** Частина логіки (наприклад, перерахунок залишків при ручному редагуванні) наразі знаходиться у файлі `gui_main.py`. Для кращої архітектури її можна було б винести у `shopify_tool/core.py`.
-   **Відсутність збереження стану сесії:** Програма не зберігає завантажені дані (`DataFrame`) між запусками. Якщо користувач закриє програму, результати аналізу будуть втрачені, і потрібно буде починати спочатку. Можна додати функціонал збереження та завантаження стану сесії.
